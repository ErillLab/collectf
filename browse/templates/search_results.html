{% extends "base.html" %} 

{% block head-extras %}
<title> CollecTF - {{ title }} </title>
{% endblock %}

{% block content %}

{% load browsetags  %}

<div id="description" class="boxed">
  <h4>{{ title }}</h4>
  <p> {{ description|HTMLify }}</p>
</div>

<div id="report_table" class="boxed">
  {% if reports %}
  {# put view_all link #}
  <p>
    <a class="block_before_load" href="#"  onclick="$('#view_all').submit(); return false;">
      Combined report
    </a>
  </p>
  <form style="display:inline;" method="post"
        action="{% url 'browse.view_reports.view_reports_by_id_list' %}" id="view_all"
        target="_blank">
    {% comment %}
    Hidden input listing all motif-associated-curation-site-instance and
    non-motif-associated curation-site-instance-ids
    {% endcomment %}
    {% csrf_token %}
    <input type="hidden" name="csi_list"
           value="{% for report in reports %}{% for csi in report.curation_site_instance_ids %}{{ csi }}{% if not forloop.last %},{% endif %}{% endfor %}{% endfor %}">
  </form>

  <table class="table table-condensed table-striped">
    <thead>
      <th>TF</th>
      <th>Species</th>
      <th>Report</th>
    </thead>
    <tbody>
      {% for report in reports %}
      <tr>
        <td>{{ report.TF.name }}</td>
        <td>{{ report.species.name }}</td>
        {% with form_id=report.TF.name|slugify|add:'_'|add:report.species.name|slugify %}
        <td>
	      <a class="" href="#" onclick="$('#{{ form_id }}').submit(); return false;">
            view
          </a>
	      <form style="display:inline;" method="post"
                action="{% url 'browse.view_reports.view_reports_by_id_list' %}"
                id="{{ form_id }}" target="_blank">
            {% csrf_token %}
	        <input type="hidden" name="csi_list"
                   value="{% for csi_pk in report.curation_site_instance_ids %}{{ csi_pk }}{% if not forloop.last %},{% endif %}{% endfor %}">
	      </form>
        </td>
        {% endwith %}
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% else %}
  <p class="text-warning">No record was found.</p>
  {% endif %}
</div>


{% endblock %}
